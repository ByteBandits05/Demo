# Databricks Asset Bundle deployment configuration for Demo
bundle:
  name: demo-databricks-bundle

# Environment targets for deployment
targets:
  dev:  # Development environment (default)
    default: true
    workspace:
      host: https://dbc-d56de9ca-1926.cloud.databricks.com/
      root_path: /Workspace/Demo
  qa:   # Quality Assurance environment
    workspace:
      host: https://dbc-d56de9ca-1926.cloud.databricks.com/
      root_path: /Workspace/Demo
  prod: # Production environment
    workspace:
      host: https://dbc-d56de9ca-1926.cloud.databricks.com/
      root_path: /Workspace/Demo

resources:
  jobs:
    pytest:  # Job to run Pytest notebooks in the Demo bundle
      name: pytest
      tasks:
        - task_key: "run_pytest"
          notebook_task:
            notebook_path: /Workspace/Demo/files/pytest/test_file  # Explicit notebook path
      queue:
        enabled: true  # Enable job queueing
      performance_target: STANDARD
      tags:
        environment: ${bundle.target}  # Dynamically set to the active environment
        job_type: testing              # Static value for job type
      timeout_seconds: 3600            # 1 hour timeout

    smoke_test:  # Job to run smoke tests on the Demo bundle
      name: smoke_test
      tasks:
        - task_key: "run_smoke_test"
          notebook_task:
            notebook_path: "/Workspace/Demo/files/smoketest/smoke_test"
          timeout_seconds: 1800
      queue:
        enabled: true  # Enable job queueing
      performance_target: STANDARD
      tags:
        environment: ${bundle.target}  # Dynamically set to the active environment
        job_type: validation           # Static value for job type
      timeout_seconds: 1800            # 30 minutes timeout
