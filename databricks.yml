# Databricks Asset Bundle Configuration
# This file defines the bundle configuration for deploying across dev, qa, and prod environments

bundle:
  name: demo-databricks-bundle

# No variables sectionâ€”values are used directly below

targets:
  # Development environment (default)
  dev:
    default: true
    workspace:
      host: "https://dbc-d56de9ca-1926.cloud.databricks.com/"
      root_path: "/Workspace/Demo"

  # QA environment
  qa:
    workspace:
      host: "https://dbc-d56de9ca-1926.cloud.databricks.com/"
      root_path: "/Workspace/Demo"

  # Production environment
  prod:
    workspace:
      host: "https://dbc-d56de9ca-1926.cloud.databricks.com/"
      root_path: "/Workspace/Demo"

resources:
  jobs:
    # Pytest job: Runs unit tests using the test file
    pytest:
      name: "pytest-job-${bundle.target}"
      tasks:
        - task_key: "run_pytest"
          notebook_task:
            notebook_path: "/Workspace/Demo/files/pytest/test_file"
          timeout_seconds: 3600
      queue:
        enabled: true
      performance_target: STANDARD
      tags:
        environment: "${bundle.target}"
        job_type: "testing"

    # Smoke test job: Validates environment health
    smoke_test:
      name: "smoke-test-job-${bundle.target}"
      tasks:
        - task_key: "run_smoke_test"
          notebook_task:
            notebook_path: "/Workspace/Demo/files/smoketest/smoke_test"
          timeout_seconds: 1800
      queue:
        enabled: true
      performance_target: STANDARD
      tags:
        environment: "${bundle.target}"
        job_type: "validation"
